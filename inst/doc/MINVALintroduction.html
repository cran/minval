<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Introduction to MINVAL</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h3>Introduction to MINVAL</h3>

<p>The <strong>MINVAL</strong> package was designed as a tool to identify orphan metabolites and evaluate the mass and charge balance of stoichiometric reactions. The package also includes functions to characterize and write models in TSV and SBML formats, extract all reactants, products, metabolite names and compartments from a metabolic reconstruction. It is available through CRAN repositories, to install it just type:</p>

<pre><code class="r">install.packages(&quot;minval&quot;)
</code></pre>

<p><strong>MINVAL</strong> package includes twelve functions designed to characterize, check and depurate metabolic reconstructions before its interrogation through Flux Balance Analysis (FBA). FBA methods are available for the R language in the <code>&quot;sybil&quot;</code> (<strong>Sy</strong>stems <strong>Bi</strong>ology <strong>L</strong>ibrary) package. To load required packages just type:</p>

<pre><code class="r">library(&quot;minval&quot;)
library(&quot;sybilSBML&quot;)
</code></pre>

<h3>Metabolic Models</h3>

<p>Metabolic models are sets of stoichiometric reactions that represents a process where a set of chemical compounds called reactants are converted into others called products. In a stoichiometric reaction, all the reactants are placed on the left and the products on the right separated by an arrow symbol which indicates the direction of the reaction. Some examples of valid stoichiometric reactions are:</p>

<pre><code class="r">&quot;H2O[c] + Urea-1-Carboxylate[c] &lt;=&gt; 2 CO2[c] + 2 NH3[c]&quot;
&quot;ADP[c] + Phosphoenolpyruvate[c] =&gt; ATP[c] + Pyruvate[c]&quot;
&quot;CO2[c] &lt;=&gt;&quot;
</code></pre>

<p><strong>MINVAL</strong> can extract both, reactants and products for a set of stoichiometric reactions through the <code>reactants</code> and <code>products</code> functions as follows: </p>

<ul>
<li>If the reaction is irreversible <code>&quot;=&gt;&quot;</code> then reactants and products are separated and returned afterward.</li>
</ul>

<pre><code class="r">reactants(reactionList = &quot;ADP[c] + Phosphoenolpyruvate[c] =&gt; ATP[c] + Pyruvate[c]&quot;)
## [1] &quot;ADP[c]&quot;                 &quot;Phosphoenolpyruvate[c]&quot;
products(reactionList = &quot;ADP[c] + Phosphoenolpyruvate[c] =&gt; ATP[c] + Pyruvate[c]&quot;)
## [1] &quot;ATP[c]&quot;      &quot;Pyruvate[c]&quot;
</code></pre>

<ul>
<li>If the reaction is reversible <code>&quot;&lt;=&gt;&quot;</code> then all reactants at some point can act as products and <em>vice versa</em>, for that reason both functions return all reaction metabolites.</li>
</ul>

<pre><code class="r">reactants(reactionList = &quot;H2O[c] + Urea-1-Carboxylate[c] &lt;=&gt; 2 CO2[c] + 2 NH3[c]&quot;)
## [1] &quot;H2O[c]&quot;                &quot;Urea-1-Carboxylate[c]&quot; &quot;CO2[c]&quot;               
## [4] &quot;NH3[c]&quot;
products(reactionList = &quot;H2O[c] + Urea-1-Carboxylate[c] &lt;=&gt; 2 CO2[c] + 2 NH3[c]&quot;)
## [1] &quot;H2O[c]&quot;                &quot;Urea-1-Carboxylate[c]&quot; &quot;CO2[c]&quot;               
## [4] &quot;NH3[c]&quot;
</code></pre>

<p>To show the potential use of the <strong>MINVAL</strong> package a human-readable model composed by a set of 19 stoichiometric reactions that represent an unbalanced model of the glycolysis process was included. To load it just type:</p>

<pre><code class="r">glycolysis &lt;- read.csv(file = system.file(&quot;extdata&quot;, &quot;glycolysisModel.csv&quot;,
                                          package = &quot;minval&quot;), 
                        stringsAsFactors = FALSE,
                        sep = &#39;\t&#39;
                        )
glycolysis$REACTION
##  [1] &quot;2-Phospho-D-glycerate[c] &lt;=&gt; Phosphoenolpyruvate[c] + H2O[c]&quot;                                                            
##  [2] &quot;D-Glyceraldehyde 3-phosphate[c] &lt;=&gt; Glycerone phosphate[c]&quot;                                                              
##  [3] &quot;D-Glyceraldehyde 3-phosphate[c] + Orthophosphate[c] + NAD+[c] &lt;=&gt; 3 3-Phospho-D-glyceroyl phosphate[c] + NADH[c] + H+[c]&quot;
##  [4] &quot;beta-D-Fructose 1,6-bisphosphate[c] &lt;=&gt; Glycerone phosphate[c] + D-Glyceraldehyde 3-phosphate[c]&quot;                        
##  [5] &quot;ATP[c] + 3-Phospho-D-glycerate[c] &lt;=&gt; ADP[c] + 3-Phospho-D-glyceroyl phosphate[c]&quot;                                       
##  [6] &quot;2-Phospho-D-glycerate[c] &lt;=&gt; 3-Phospho-D-glycerate[c]&quot;                                                                   
##  [7] &quot;ATP[c] + alpha-D-Glucose[c] =&gt; ADP[c] + alpha-D-Glucose 6-phosphate[c]&quot;                                                  
##  [8] &quot;alpha-D-Glucose 6-phosphate[c] &lt;=&gt; beta-D-Fructose 6-phosphate[c]&quot;                                                       
##  [9] &quot;ATP[c] + beta-D-Fructose 6-phosphate[c] =&gt; ADP[c] + beta-D-Fructose 1,6-bisphosphate[c]&quot;                                 
## [10] &quot;ADP[c] + Phosphoenolpyruvate[c] =&gt; ATP[c] + Pyruvate[c]&quot;                                                                 
## [11] &quot;H2O[c] &lt;=&gt;&quot;                                                                                                              
## [12] &quot;NAD+[c] &lt;=&gt;&quot;                                                                                                             
## [13] &quot;NADH[c] &lt;=&gt;&quot;                                                                                                             
## [14] &quot;Orthophosphate[c] &lt;=&gt;&quot;                                                                                                   
## [15] &quot;H+[c] &lt;=&gt;&quot;                                                                                                               
## [16] &quot;ATP[c] &lt;=&gt;&quot;                                                                                                              
## [17] &quot;alpha-D-Glucose[c] &lt;=&gt;&quot;                                                                                                  
## [18] &quot;Pyruvate[c] &lt;=&gt;&quot;                                                                                                         
## [19] &quot;ADP[c] &lt;=&gt;&quot;
</code></pre>

<p>Metabolic models include also another additional information related to the stoichiometric reactions. The generally associated information is:</p>

<ul>
<li><strong>ID:</strong> A list of single character strings containing the reaction abbreviations, Entries in the field abbreviation are used as reaction ids, so they must be unique.</li>
<li><strong>REACTION:</strong> A set of stoichiometric reaction with the following characteristics:

<ul>
<li>Arrows symbols must be given in the form <code>&#39;=&gt;&#39;</code> or <code>&#39;&lt;=&gt;&#39;</code></li>
<li>Inverse arrow symbols <code>&#39;&lt;=&#39;</code> or other types as: <code>&#39;--&gt;&#39;</code>, <code>&#39;&lt;==&gt;&#39;</code>, <code>&#39;-&gt;&#39;</code> will not be parsed and will lead to errors.</li>
<li>Arrow symbols and plus signs (<code>+</code>) must be surrounded by a space character.</li>
<li>Stoichiometric coefficients must be surrounded by a space character and not by parentheses.</li>
<li>Each metabolite must have only one stoichiometric coefficient, substituents must be joined to metabolite name by a hyphen (<code>-</code>) symbol.</li>
<li>Exchange reactions must have only one metabolite before arrow symbol.</li>
<li>Compartments must be given between square brackets (<code>[compartment]</code>) joined at the end of metabolite name.</li>
</ul></li>
<li><strong>GPR:</strong> A set of genes joined by boolean operators as <code>AND</code> or <code>OR</code>, rules may be nested by parenthesis. (optional: column can be empty)</li>
<li><strong>LOWER.BOUND:</strong> A list of numeric values containing the lower bounds of the reaction rates. If not set, zero is used for an irreversible reaction and -1000 for a reversible reaction. (optional: column can be empty)</li>
<li><strong>UPPER.BOUND:</strong> list of numeric values containing the upper bounds of the reaction rates. If not set, 1000 is used by default. (optional: column can be empty)</li>
<li><strong>OBJECTIVE:</strong> A list of numeric values containing objective values (0 or 1) for each reaction (optional: column can be empty)</li>
</ul>

<pre><code class="r">colnames(glycolysis)
## [1] &quot;ID&quot;          &quot;DESCRIPTION&quot; &quot;REACTION&quot;    &quot;GPR&quot;         &quot;LOWER.BOUND&quot;
## [6] &quot;UPPER.BOUND&quot; &quot;OBJECTIVE&quot;
</code></pre>

<h3>SBML files</h3>

<p>The standard format to share and store biological processes such as metabolic models is the Systems Biology Markup Language (SBML) format. <strong>MINVAL</strong> package includes the <code>&quot;writeSBMLmod&quot;</code> function which is able to write models in SBML (<code>level = 2</code>, <code>version = 1</code>) format as follows:</p>

<pre><code class="r">writeSBMLmod(modelData = glycolysis,
          modelID = &quot;Glycolysis&quot;,
          outputFile = &quot;glycolysis.xml&quot;
          )
</code></pre>

<p>Metabolic models in SBML format can be readed through the <code>readSBMLmod</code> function of the <code>sybilSBML</code> R package.</p>

<pre><code class="r">glycoModel &lt;- sybilSBML::readSBMLmod(&quot;glycolysis.xml&quot;)
glycoModel
## model name:             Glycolysis 
## number of compartments  2 
##                         c 
##                         b 
## number of reactions:    19 
## number of metabolites:  18 
## number of unique genes: 22 
## objective function:     +1 R00200
</code></pre>

<p>After load the metabolic model, it can be interrogated through FBA using the <code>optimizeProb</code> function of the <code>sybil</code> R package. In this case, the reaction <code>R00200</code> was set as the objective function. The <code>R00200</code> reaction describes the production of pyruvate from phosphoenolpyruvate an alpha-D-Glucose derivate.</p>

<p>Glycolysis pathway can be summarized as: <code>1 alpha-D-Glucose[c] + 2 NAD+[c] + 2 ADP[c] + 2 Orthophosphate[c] =&gt; 2 Pyruvate[c] + 2 NADH[c] + 2 H+[c] + 2 ATP[c] + 2 H2O[c]</code> where the metabolism of one molecule of alpha-D-Glucose yield two molecules of pyruvate. </p>

<p>As is shown below, interrogated glycolysis model estimates a production of six molecules of pyruvate by each alpha-D-Glucose molecule due a mass unbalance. FBA methods are sensitive to thermodynamic (mass-charge) unbalance, so in order to achieve a valid biological extrapolation is mandatory to avoid this type of unbalancing in all model reactions.</p>

<pre><code class="r">sybil::optimizeProb(glycoModel)
## solver:                                   glpkAPI
## method:                                   simplex
## algorithm:                                fba
## number of variables:                      19
## number of constraints:                    18
## return value of solver:                   solution process was successful
## solution status:                          solution is optimal
## value of objective function (fba):        6.000000
## value of objective function (model):      6.000000
</code></pre>

<h3>Syntax validation</h3>

<p>The first step for a stoichiometric reactions validation is to check their syntax. Valid stoichiometric reactions must have the following mandatory characteristics:</p>

<ul>
<li>Arrows symbols must be given in the form <code>&#39;=&gt;&#39;</code> or <code>&#39;&lt;=&gt;&#39;</code> (Inverse arrow symbols <code>&#39;&lt;=&#39;</code> or other types as: <code>&#39;--&gt;&#39;</code>, <code>&#39;&lt;==&gt;&#39;</code>, <code>&#39;-&gt;&#39;</code> will not be parsed and will lead to errors.)</li>
<li>Arrow symbols and plus signs (<code>+</code>) must be surrounded by a space character.</li>
<li>Stoichiometric coefficients must be surrounded by a space character and not by parentheses.</li>
<li>Each metabolite must have only one stoichiometric coefficient, substituents must be joined to metabolite name by a hyphen (<code>-</code>) symbol.</li>
<li>Exchange reactions must have only one metabolite before arrow symbol.</li>
<li>Compartments must be given between square brackets (<code>[compartment]</code>) joined at the end of metabolite name.</li>
</ul>

<p>Syntax validity can be checked through <strong>MINVAL</strong> package using the <code>validateSyntax</code> function which returns a boolean <code>TRUE</code> value if the stoichiometric reaction passes all validations. To validate reactions syntax just type:</p>

<pre><code class="r">validateSyntax(reactionList = glycolysis$REACTION)
##  [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
## [15] TRUE TRUE TRUE TRUE TRUE
</code></pre>

<h3>Mass - Charge Balance Validation</h3>

<p>Another step for a stoichiometric reactions validation is to check their mass-charge balance. This process requires the use of a reference with chemical formulas, molecular weights and/or net charges for each metabolite included in the metabolic model.</p>

<h4>ChEBI database download</h4>

<p><strong>MINVAL</strong> package includes the <code>downloadChEBI</code> function that allows the download of different releases of the Chemical Entities of Biological Interest (ChEBI) database, a freely available dictionary of molecular entities focused on &#39;small&#39; chemical compounds involved in biochemical reactions. To download the latest version (this process takes aprox. 2 min with a 5 Mb internet connection) of the ChEBI database just type:</p>

<pre><code class="r">ChEBI &lt;- downloadChEBI(release = &quot;latest&quot;,
                       woAssociations = TRUE
                       )
</code></pre>

<p>Reference also can be user provided. An example of a reference for the glycolysis model is shown below.</p>

<pre><code class="r">chemicalData &lt;- read.csv2(file = system.file(&quot;extdata&quot;, &quot;chemData.csv&quot;, 
                                             package = &quot;minval&quot;)
                          )
head(chemicalData)
##                              NAME       FORMULA     MASS CHARGE
## 1                             H2O           H2O  18.0106      0
## 2                              H+             H   1.0078      1
## 3                             ATP C10H16N5O13P3 506.9957      0
## 4                            NAD+ C21H28N7O14P2 664.1169      1
## 5 3-Phospho-D-glyceroyl phosphate     C3H8O10P2 265.9593      0
## 6     beta-D-Fructose 6-phosphate      C6H13O9P 260.0297      0
</code></pre>

<h4>Mass Balance Validation</h4>

<p>In a balanced stoichiometric reaction according to the <em>Lomonosov-Lavoisier</em> law, the mass comprising the reactants should be the same mass present in the products. If the chemical formula is given, the <code>checkBalance</code> function multiplies the atom numbers by their respective stoichiometric coefficient and establishes if the atomic composition of reactants and products are the same. If the molecular weight is given then the sum of masses of reactants and products are compared. In both cases, a boolean <code>TRUE</code> value is returned if the mass is balanced.</p>

<p>Mass balance can be tested using the chemical formula or the molecular weight associated to each metabolite as follows:</p>

<pre><code class="r">checkBalance(reactionList = glycolysis$REACTION,
             referenceData = chemicalData,
             ids = &quot;NAME&quot;,
             mFormula = &quot;FORMULA&quot;
             )
##  [1]  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
## [12]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
</code></pre>

<p>As is shown above, the third stoichiometric reaction is unbalanced. It can be corrected replacing manually the unbalanced reaction as follows:</p>

<pre><code class="r">glycolysis$REACTION[3] &lt;- &quot;D-Glyceraldehyde 3-phosphate[c] + Orthophosphate[c] + NAD+[c] &lt;=&gt; 3-Phospho-D-glyceroyl phosphate[c] + NADH[c] + H+[c]&quot;

checkBalance(reactionList = glycolysis$REACTION,
             referenceData = chemicalData,
             ids = &quot;NAME&quot;,
             mWeight = &quot;MASS&quot;
             )
##  [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
## [15] TRUE TRUE TRUE TRUE TRUE
</code></pre>

<p>When all stoichiometric reactions are mass-balanced, then the model can be exported and loaded to be interrogated again:</p>

<pre><code class="r">writeSBMLmod(modelData = glycolysis,
          modelID = &quot;GlycolysisBalanced&quot;,
          outputFile = &quot;glycolysisBalanced.xml&quot;
          )

sybil::optimizeProb(sybilSBML::readSBMLmod(&quot;glycolysisBalanced.xml&quot;))
## solver:                                   glpkAPI
## method:                                   simplex
## algorithm:                                fba
## number of variables:                      19
## number of constraints:                    18
## return value of solver:                   solution process was successful
## solution status:                          solution is optimal
## value of objective function (fba):        2.000000
## value of objective function (model):      2.000000
</code></pre>

<h4>Charge Balance Validation</h4>

<p>Charge balance can be also tested through the <code>checkBalance</code> function using the net charge of metabolites as follows:</p>

<pre><code class="r">checkBalance(reactionList = glycolysis$REACTION,
             referenceData = chemicalData,
             ids = &quot;NAME&quot;,
             mCharge = &quot;CHARGE&quot;
             )
##  [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
## [15] TRUE TRUE TRUE TRUE TRUE
</code></pre>

<h3>Characterize model</h3>

<h4>Stoichiometric matrix</h4>

<p>A metabolic model is often represented in a more compact form called the stoichiometry matrix (<em>S</em>). If a metabolic model has <em>n</em> reactions and <em>m</em> participating metabolites, then the stoichiometry matrix will have correspondingly <em>m</em> rows and <em>n</em> columns. Values in the stoichiometric matrix represent the metabolites coefficients in each reaction. To generate the stoichiometric matrix just type:</p>

<pre><code class="r">stoichiometricMatrix(reactionList = glycolysis$REACTION)
##                                      reactions
## metabolites                           R01 R02 R03 R04 R05 R06 R07 R08 R09
##   2-Phospho-D-glycerate[c]             -1   0   0   0   0  -1   0   0   0
##   Phosphoenolpyruvate[c]                1   0   0   0   0   0   0   0   0
##   H2O[c]                                1   0   0   0   0   0   0   0   0
##   D-Glyceraldehyde 3-phosphate[c]       0  -1  -1   1   0   0   0   0   0
##   Glycerone phosphate[c]                0   1   0   1   0   0   0   0   0
##   Orthophosphate[c]                     0   0  -1   0   0   0   0   0   0
##   NAD+[c]                               0   0  -1   0   0   0   0   0   0
##   3-Phospho-D-glyceroyl phosphate[c]    0   0   1   0   1   0   0   0   0
##   NADH[c]                               0   0   1   0   0   0   0   0   0
##   H+[c]                                 0   0   1   0   0   0   0   0   0
##   beta-D-Fructose 1,6-bisphosphate[c]   0   0   0  -1   0   0   0   0   1
##   ATP[c]                                0   0   0   0  -1   0  -1   0  -1
##   3-Phospho-D-glycerate[c]              0   0   0   0  -1   1   0   0   0
##   ADP[c]                                0   0   0   0   1   0   1   0   1
##   alpha-D-Glucose[c]                    0   0   0   0   0   0  -1   0   0
##   alpha-D-Glucose 6-phosphate[c]        0   0   0   0   0   0   1  -1   0
##   beta-D-Fructose 6-phosphate[c]        0   0   0   0   0   0   0   1  -1
##   Pyruvate[c]                           0   0   0   0   0   0   0   0   0
##                                      reactions
## metabolites                           R10 R11 R12 R13 R14 R15 R16 R17 R18
##   2-Phospho-D-glycerate[c]              0   0   0   0   0   0   0   0   0
##   Phosphoenolpyruvate[c]               -1   0   0   0   0   0   0   0   0
##   H2O[c]                                0  -1   0   0   0   0   0   0   0
##   D-Glyceraldehyde 3-phosphate[c]       0   0   0   0   0   0   0   0   0
##   Glycerone phosphate[c]                0   0   0   0   0   0   0   0   0
##   Orthophosphate[c]                     0   0   0   0  -1   0   0   0   0
##   NAD+[c]                               0   0  -1   0   0   0   0   0   0
##   3-Phospho-D-glyceroyl phosphate[c]    0   0   0   0   0   0   0   0   0
##   NADH[c]                               0   0   0  -1   0   0   0   0   0
##   H+[c]                                 0   0   0   0   0  -1   0   0   0
##   beta-D-Fructose 1,6-bisphosphate[c]   0   0   0   0   0   0   0   0   0
##   ATP[c]                                1   0   0   0   0   0  -1   0   0
##   3-Phospho-D-glycerate[c]              0   0   0   0   0   0   0   0   0
##   ADP[c]                               -1   0   0   0   0   0   0   0   0
##   alpha-D-Glucose[c]                    0   0   0   0   0   0   0  -1   0
##   alpha-D-Glucose 6-phosphate[c]        0   0   0   0   0   0   0   0   0
##   beta-D-Fructose 6-phosphate[c]        0   0   0   0   0   0   0   0   0
##   Pyruvate[c]                           1   0   0   0   0   0   0   0  -1
##                                      reactions
## metabolites                           R19
##   2-Phospho-D-glycerate[c]              0
##   Phosphoenolpyruvate[c]                0
##   H2O[c]                                0
##   D-Glyceraldehyde 3-phosphate[c]       0
##   Glycerone phosphate[c]                0
##   Orthophosphate[c]                     0
##   NAD+[c]                               0
##   3-Phospho-D-glyceroyl phosphate[c]    0
##   NADH[c]                               0
##   H+[c]                                 0
##   beta-D-Fructose 1,6-bisphosphate[c]   0
##   ATP[c]                                0
##   3-Phospho-D-glycerate[c]              0
##   ADP[c]                               -1
##   alpha-D-Glucose[c]                    0
##   alpha-D-Glucose 6-phosphate[c]        0
##   beta-D-Fructose 6-phosphate[c]        0
##   Pyruvate[c]                           0
</code></pre>

<h4>Metabolites</h4>

<p>The <code>metabolites</code> function automatically identifies and return all metabolites (with or without compartments) for a specific or a set of stoichiometric reactions. Some FBA implementations require the list of all metabolites included in the metabolic reconstruction as an independent section of the human-readable input model.</p>

<pre><code class="r">metabolites(reactionList = glycolysis$REACTION)
##  [1] &quot;2-Phospho-D-glycerate[c]&quot;           
##  [2] &quot;Phosphoenolpyruvate[c]&quot;             
##  [3] &quot;H2O[c]&quot;                             
##  [4] &quot;D-Glyceraldehyde 3-phosphate[c]&quot;    
##  [5] &quot;Glycerone phosphate[c]&quot;             
##  [6] &quot;Orthophosphate[c]&quot;                  
##  [7] &quot;NAD+[c]&quot;                            
##  [8] &quot;3-Phospho-D-glyceroyl phosphate[c]&quot; 
##  [9] &quot;NADH[c]&quot;                            
## [10] &quot;H+[c]&quot;                              
## [11] &quot;beta-D-Fructose 1,6-bisphosphate[c]&quot;
## [12] &quot;ATP[c]&quot;                             
## [13] &quot;3-Phospho-D-glycerate[c]&quot;           
## [14] &quot;ADP[c]&quot;                             
## [15] &quot;alpha-D-Glucose[c]&quot;                 
## [16] &quot;alpha-D-Glucose 6-phosphate[c]&quot;     
## [17] &quot;beta-D-Fructose 6-phosphate[c]&quot;     
## [18] &quot;Pyruvate[c]&quot;
</code></pre>

<pre><code class="r">metabolites(reactionList = glycolysis$REACTION,
            woCompartment = TRUE)
##  [1] &quot;2-Phospho-D-glycerate&quot;            &quot;Phosphoenolpyruvate&quot;             
##  [3] &quot;H2O&quot;                              &quot;D-Glyceraldehyde 3-phosphate&quot;    
##  [5] &quot;Glycerone phosphate&quot;              &quot;Orthophosphate&quot;                  
##  [7] &quot;NAD+&quot;                             &quot;3-Phospho-D-glyceroyl phosphate&quot; 
##  [9] &quot;NADH&quot;                             &quot;H+&quot;                              
## [11] &quot;beta-D-Fructose 1,6-bisphosphate&quot; &quot;ATP&quot;                             
## [13] &quot;3-Phospho-D-glycerate&quot;            &quot;ADP&quot;                             
## [15] &quot;alpha-D-Glucose&quot;                  &quot;alpha-D-Glucose 6-phosphate&quot;     
## [17] &quot;beta-D-Fructose 6-phosphate&quot;      &quot;Pyruvate&quot;
</code></pre>

<h4>Compartments</h4>

<p>As well as in cells, in which not all reactions occur in all compartments,  stoichiometric reactions in a metabolic reconstruction can be labeled to be restricted to a single compartment during FBA through the assignment of  a compartment label at the end of each metabolite name. Some FBA implementations require the list of all compartments included in the metabolic reconstruction as an independent section of the human-readable input file.</p>

<pre><code class="r">compartments(reactionList = glycolysis$REACTION)
## [1] &quot;c&quot;
</code></pre>

<h4>OrphanMetabolites</h4>

<p><code>orphanMetabolites</code> or compounds that are not produced or consumed in any other reaction are one of the main causes of mass accumulation in metabolic reconstructions. The <code>orphanReactants</code> function identifies compounds that are not produced internally by any other reaction and should be added to the reconstruction, for instance, as an exchange reaction while the <code>orphanProducts</code> function identifies compounds that are not consumed internally by any other reaction and should be added to the reconstruction as a sink reaction.</p>

<pre><code class="r">orphanMetabolites(reactionList = glycolysis$REACTION[1:10])
## [1] &quot;alpha-D-Glucose[c]&quot; &quot;Pyruvate[c]&quot;        &quot;H+[c]&quot;             
## [4] &quot;H2O[c]&quot;             &quot;NAD+[c]&quot;            &quot;NADH[c]&quot;           
## [7] &quot;Orthophosphate[c]&quot;
</code></pre>

<pre><code class="r">orphanReactants(reactionList = glycolysis$REACTION[1:10])
## [1] &quot;alpha-D-Glucose[c]&quot; &quot;H+[c]&quot;              &quot;H2O[c]&quot;            
## [4] &quot;NAD+[c]&quot;            &quot;NADH[c]&quot;            &quot;Orthophosphate[c]&quot;
orphanProducts(reactionList = glycolysis$REACTION[1:10])
## [1] &quot;Pyruvate[c]&quot;       &quot;H+[c]&quot;             &quot;H2O[c]&quot;           
## [4] &quot;NAD+[c]&quot;           &quot;NADH[c]&quot;           &quot;Orthophosphate[c]&quot;
</code></pre>

<h3>TSV files</h3>

<p>The function <code>writeTSVmod</code> writes a metabolic model in three text files, following a character-separated value format. Each line contains one entry; the default value separator is a tab. TSV models are the default input format for the <code>sybil</code> R package.</p>

<pre><code class="r">writeTSVmod(modelData = glycolysis,
          modelID = &quot;Glycolysis&quot;,
          outputFile = &quot;glycolysis&quot;
          )

sybil::readTSVmod(prefix = &quot;glycolysis&quot;,quoteChar = &quot;\&quot;&quot;)
## model name:             Glycolysis 
## number of compartments  1 
##                         [c] 
## number of reactions:    19 
## number of metabolites:  18 
## number of unique genes: 22 
## objective function:     +1 R00200
</code></pre>

</body>

</html>
