<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Daniel Osorio, Janneth Gonzalez and Andres Pinzon" />


<title>MINVAL - MINimal VALidation for Stoichiometric Reactions</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">MINVAL - <strong>MIN</strong>imal <strong>VAL</strong>idation for Stoichiometric Reactions</h1>
<h4 class="author"><em>Daniel Osorio, Janneth Gonzalez and Andres Pinzon</em></h4>



<div id="introduction-to-minval" class="section level3">
<h3>Introduction to MINVAL</h3>
<p>The <strong>MINVAL</strong> package was designed as a tool to identify orphan metabolites and evaluate the mass and charge balance of stoichiometric reactions. The package also includes functions to characterize and write models in TSV and SBML formats, extract all reactants, products, metabolite names and compartments from a metabolic reconstruction. It is available through CRAN repositories, to install it just type:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;minval&quot;</span>)</code></pre></div>
<p><strong>MINVAL</strong> package includes twelve functions designed to characterize, check and depurate metabolic reconstructions before its interrogation through Flux Balance Analysis (FBA). FBA methods are available for the R language in the <code>&quot;sybil&quot;</code> (<strong>Sy</strong>stems <strong>Bi</strong>ology <strong>L</strong>ibrary) package. To load required packages just type:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;minval&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;sybilSBML&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;sybil&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;glpkAPI&quot;</span>)</code></pre></div>
</div>
<div id="metabolic-models" class="section level3">
<h3>Metabolic Models</h3>
<p>Metabolic models are sets of stoichiometric reactions that represents a process where a set of chemical compounds called reactants are converted into others called products. In a stoichiometric reaction, all the reactants are placed on the left and the products on the right separated by an arrow symbol which indicates the direction of the reaction. Some examples of valid stoichiometric reactions are:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="st">&quot;H2O[c] + Urea-1-Carboxylate[c] &lt;=&gt; 2 CO2[c] + 2 NH3[c]&quot;</span>
<span class="st">&quot;ADP[c] + Phosphoenolpyruvate[c] =&gt; ATP[c] + Pyruvate[c]&quot;</span>
<span class="st">&quot;CO2[c] &lt;=&gt;&quot;</span></code></pre></div>
<p><strong>MINVAL</strong> can extract both, reactants and products for a set of stoichiometric reactions through the <code>reactants</code> and <code>products</code> functions as follows:</p>
<ul>
<li>If the reaction is irreversible <code>&quot;=&gt;&quot;</code> then reactants and products are separated and returned afterward.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">reactants</span>(<span class="dt">reactionList =</span> <span class="st">&quot;ADP[c] + Phosphoenolpyruvate[c] =&gt; ATP[c] + Pyruvate[c]&quot;</span>)
## [1] &quot;ADP[c]&quot;                 &quot;Phosphoenolpyruvate[c]&quot;
<span class="kw">products</span>(<span class="dt">reactionList =</span> <span class="st">&quot;ADP[c] + Phosphoenolpyruvate[c] =&gt; ATP[c] + Pyruvate[c]&quot;</span>)
## [1] &quot;ATP[c]&quot;      &quot;Pyruvate[c]&quot;</code></pre></div>
<ul>
<li>If the reaction is reversible <code>&quot;&lt;=&gt;&quot;</code> then all reactants at some point can act as products and <em>vice versa</em>, for that reason both functions return all reaction metabolites.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">reactants</span>(<span class="dt">reactionList =</span> <span class="st">&quot;H2O[c] + Urea-1-Carboxylate[c] &lt;=&gt; 2 CO2[c] + 2 NH3[c]&quot;</span>)
## [1] &quot;H2O[c]&quot;                &quot;Urea-1-Carboxylate[c]&quot; &quot;CO2[c]&quot;               
## [4] &quot;NH3[c]&quot;
<span class="kw">products</span>(<span class="dt">reactionList =</span> <span class="st">&quot;H2O[c] + Urea-1-Carboxylate[c] &lt;=&gt; 2 CO2[c] + 2 NH3[c]&quot;</span>)
## [1] &quot;H2O[c]&quot;                &quot;Urea-1-Carboxylate[c]&quot; &quot;CO2[c]&quot;               
## [4] &quot;NH3[c]&quot;</code></pre></div>
<p>To show the potential use of the <strong>MINVAL</strong> package a human-readable model composed by a set of 19 stoichiometric reactions that represent an unbalanced model of the glycolysis process was included. To load it just type:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">glycolysis &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file =</span> <span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;glycolysisModel.csv&quot;</span>,
                                          <span class="dt">package =</span> <span class="st">&quot;minval&quot;</span>), 
                        <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>,
                        <span class="dt">sep =</span> <span class="st">'</span><span class="ch">\t</span><span class="st">'</span>
                        )
glycolysis<span class="op">$</span>REACTION
##  [1] &quot;2-Phospho-D-glycerate[c] &lt;=&gt; Phosphoenolpyruvate[c] + H2O[c]&quot;                                                            
##  [2] &quot;D-Glyceraldehyde 3-phosphate[c] &lt;=&gt; Glycerone phosphate[c]&quot;                                                              
##  [3] &quot;D-Glyceraldehyde 3-phosphate[c] + Orthophosphate[c] + NAD+[c] &lt;=&gt; 3 3-Phospho-D-glyceroyl phosphate[c] + NADH[c] + H+[c]&quot;
##  [4] &quot;beta-D-Fructose 1,6-bisphosphate[c] &lt;=&gt; Glycerone phosphate[c] + D-Glyceraldehyde 3-phosphate[c]&quot;                        
##  [5] &quot;ATP[c] + 3-Phospho-D-glycerate[c] &lt;=&gt; ADP[c] + 3-Phospho-D-glyceroyl phosphate[c]&quot;                                       
##  [6] &quot;2-Phospho-D-glycerate[c] &lt;=&gt; 3-Phospho-D-glycerate[c]&quot;                                                                   
##  [7] &quot;ATP[c] + alpha-D-Glucose[c] =&gt; ADP[c] + alpha-D-Glucose 6-phosphate[c]&quot;                                                  
##  [8] &quot;alpha-D-Glucose 6-phosphate[c] &lt;=&gt; beta-D-Fructose 6-phosphate[c]&quot;                                                       
##  [9] &quot;ATP[c] + beta-D-Fructose 6-phosphate[c] =&gt; ADP[c] + beta-D-Fructose 1,6-bisphosphate[c]&quot;                                 
## [10] &quot;ADP[c] + Phosphoenolpyruvate[c] =&gt; ATP[c] + Pyruvate[c]&quot;                                                                 
## [11] &quot;H2O[c] &lt;=&gt;&quot;                                                                                                              
## [12] &quot;NAD+[c] &lt;=&gt;&quot;                                                                                                             
## [13] &quot;NADH[c] &lt;=&gt;&quot;                                                                                                             
## [14] &quot;Orthophosphate[c] &lt;=&gt;&quot;                                                                                                   
## [15] &quot;H+[c] &lt;=&gt;&quot;                                                                                                               
## [16] &quot;ATP[c] &lt;=&gt;&quot;                                                                                                              
## [17] &quot;alpha-D-Glucose[c] &lt;=&gt;&quot;                                                                                                  
## [18] &quot;Pyruvate[c] &lt;=&gt;&quot;                                                                                                         
## [19] &quot;ADP[c] &lt;=&gt;&quot;</code></pre></div>
<p>Metabolic models include also another additional information related to the stoichiometric reactions. The generally associated information is:</p>
<ul>
<li><strong>ID:</strong> A list of single character strings containing the reaction abbreviations, Entries in the field abbreviation are used as reaction ids, so they must be unique.</li>
<li><strong>REACTION:</strong> A set of stoichiometric reaction with the following characteristics:
<ul>
<li>Arrows symbols must be given in the form <code>'=&gt;'</code> or <code>'&lt;=&gt;'</code></li>
<li>Inverse arrow symbols <code>'&lt;='</code> or other types as: <code>'--&gt;'</code>, <code>'&lt;==&gt;'</code>, <code>'-&gt;'</code> will not be parsed and will lead to errors.</li>
<li>Arrow symbols and plus signs (<code>+</code>) must be surrounded by a space character.</li>
<li>Stoichiometric coefficients must be surrounded by a space character and not by parentheses.</li>
<li>Each metabolite must have only one stoichiometric coefficient, substituents must be joined to metabolite name by a hyphen (<code>-</code>) symbol.</li>
<li>Exchange reactions must have only one metabolite before arrow symbol.</li>
<li>Compartments must be given between square brackets (<code>[compartment]</code>) joined at the end of metabolite name.</li>
</ul></li>
<li><strong>GPR:</strong> A set of genes joined by boolean operators as <code>AND</code> or <code>OR</code>, rules may be nested by parenthesis. (optional: column can be empty)</li>
<li><strong>LOWER.BOUND:</strong> A list of numeric values containing the lower bounds of the reaction rates. If not set, zero is used for an irreversible reaction and -1000 for a reversible reaction. (optional: column can be empty)</li>
<li><strong>UPPER.BOUND:</strong> list of numeric values containing the upper bounds of the reaction rates. If not set, 1000 is used by default. (optional: column can be empty)</li>
<li><strong>OBJECTIVE:</strong> A list of numeric values containing objective values (0 or 1) for each reaction (optional: column can be empty)</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">colnames</span>(glycolysis)
## [1] &quot;ID&quot;          &quot;DESCRIPTION&quot; &quot;REACTION&quot;    &quot;GPR&quot;         &quot;LOWER.BOUND&quot;
## [6] &quot;UPPER.BOUND&quot; &quot;OBJECTIVE&quot;</code></pre></div>
</div>
<div id="sbml-files" class="section level3">
<h3>SBML files</h3>
<p>The standard format to share and store biological processes such as metabolic models is the Systems Biology Markup Language (SBML) format. <strong>MINVAL</strong> package includes the <code>&quot;writeSBMLmod&quot;</code> function which is able to write models in SBML (<code>level = 2</code>, <code>version = 1</code>) format as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">writeSBMLmod</span>(<span class="dt">modelData =</span> glycolysis,
          <span class="dt">modelID =</span> <span class="st">&quot;Glycolysis&quot;</span>,
          <span class="dt">outputFile =</span> <span class="st">&quot;glycolysis.xml&quot;</span>
          )</code></pre></div>
<p>Metabolic models in SBML format can be readed through the <code>readSBMLmod</code> function of the <code>sybilSBML</code> R package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">glycoModel &lt;-<span class="st"> </span>sybilSBML<span class="op">::</span><span class="kw">readSBMLmod</span>(<span class="st">&quot;glycolysis.xml&quot;</span>)
glycoModel
## model name:             Glycolysis 
## number of compartments  1 
##                         c 
## number of reactions:    19 
## number of metabolites:  18 
## number of unique genes: 22 
## objective function:     +1 R00200</code></pre></div>
<p>After load the metabolic model, it can be interrogated through FBA using the <code>optimizeProb</code> function of the <code>sybil</code> R package. In this case, the reaction <code>R00200</code> was set as the objective function. The <code>R00200</code> reaction describes the production of pyruvate from phosphoenolpyruvate an alpha-D-Glucose derivate.</p>
<p>Glycolysis pathway can be summarized as: <code>1 alpha-D-Glucose[c] + 2 NAD+[c] + 2 ADP[c] + 2 Orthophosphate[c] =&gt; 2 Pyruvate[c] + 2 NADH[c] + 2 H+[c] + 2 ATP[c] + 2 H2O[c]</code> where the metabolism of one molecule of alpha-D-Glucose yield two molecules of pyruvate.</p>
<p>As is shown below, interrogated glycolysis model estimates a production of six molecules of pyruvate by each alpha-D-Glucose molecule due a mass unbalance. FBA methods are sensitive to thermodynamic (mass-charge) unbalance, so in order to achieve a valid biological extrapolation is mandatory to avoid this type of unbalancing in all model reactions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sybil<span class="op">::</span><span class="kw">optimizeProb</span>(glycoModel)
## solver:                                   glpkAPI
## method:                                   simplex
## algorithm:                                fba
## number of variables:                      19
## number of constraints:                    18
## return value of solver:                   solution process was successful
## solution status:                          solution is optimal
## value of objective function (fba):        6.000000
## value of objective function (model):      6.000000</code></pre></div>
</div>
<div id="syntax-validation" class="section level3">
<h3>Syntax validation</h3>
<p>The first step for a stoichiometric reactions validation is to check their syntax. Valid stoichiometric reactions must have the following mandatory characteristics:</p>
<ul>
<li>Arrows symbols must be given in the form <code>'=&gt;'</code> or <code>'&lt;=&gt;'</code> (Inverse arrow symbols <code>'&lt;='</code> or other types as: <code>'--&gt;'</code>, <code>'&lt;==&gt;'</code>, <code>'-&gt;'</code> will not be parsed and will lead to errors.)</li>
<li>Arrow symbols and plus signs (<code>+</code>) must be surrounded by a space character.</li>
<li>Stoichiometric coefficients must be surrounded by a space character and not by parentheses.</li>
<li>Each metabolite must have only one stoichiometric coefficient, substituents must be joined to metabolite name by a hyphen (<code>-</code>) symbol.</li>
<li>Exchange reactions must have only one metabolite before arrow symbol.</li>
<li>Compartments must be given between square brackets (<code>[compartment]</code>) joined at the end of metabolite name.</li>
</ul>
<p>Syntax validity can be checked through <strong>MINVAL</strong> package using the <code>validateSyntax</code> function which returns a boolean <code>TRUE</code> value if the stoichiometric reaction passes all validations. To validate reactions syntax just type:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">validateSyntax</span>(<span class="dt">reactionList =</span> glycolysis<span class="op">$</span>REACTION)
##  [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
## [15] TRUE TRUE TRUE TRUE TRUE</code></pre></div>
</div>
<div id="mass---charge-balance-validation" class="section level3">
<h3>Mass - Charge Balance Validation</h3>
<p>Another step for a stoichiometric reactions validation is to check their mass-charge balance. This process requires the use of a reference with chemical formulas, molecular weights and/or net charges for each metabolite included in the metabolic model.</p>
<div id="chebi-database-download" class="section level4">
<h4>ChEBI database download</h4>
<p><strong>MINVAL</strong> package includes the <code>downloadChEBI</code> function that allows the download of different releases of the Chemical Entities of Biological Interest (ChEBI) database, a freely available dictionary of molecular entities focused on ‘small’ chemical compounds involved in biochemical reactions. To download the latest version (this process takes aprox. 2 min with a 5 Mb internet connection) of the ChEBI database just type:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ChEBI &lt;-<span class="st"> </span><span class="kw">downloadChEBI</span>(<span class="dt">release =</span> <span class="st">&quot;latest&quot;</span>,
                       <span class="dt">woAssociations =</span> <span class="ot">TRUE</span>
                       )</code></pre></div>
<p>Reference also can be user provided. An example of a reference for the glycolysis model is shown below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">chemicalData &lt;-<span class="st"> </span><span class="kw">read.csv2</span>(<span class="dt">file =</span> <span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;chemData.csv&quot;</span>, 
                                             <span class="dt">package =</span> <span class="st">&quot;minval&quot;</span>)
                          )
<span class="kw">head</span>(chemicalData)
##                              NAME       FORMULA     MASS CHARGE
## 1                             H2O           H2O  18.0106      0
## 2                              H+             H   1.0078      1
## 3                             ATP C10H16N5O13P3 506.9957      0
## 4                            NAD+ C21H28N7O14P2 664.1169      1
## 5 3-Phospho-D-glyceroyl phosphate     C3H8O10P2 265.9593      0
## 6     beta-D-Fructose 6-phosphate      C6H13O9P 260.0297      0</code></pre></div>
</div>
<div id="mass-balance-validation" class="section level4">
<h4>Mass Balance Validation</h4>
<p>In a balanced stoichiometric reaction according to the <em>Lomonosov-Lavoisier</em> law, the mass comprising the reactants should be the same mass present in the products. If the chemical formula is given, the <code>checkBalance</code> function multiplies the atom numbers by their respective stoichiometric coefficient and establishes if the atomic composition of reactants and products are the same. If the molecular weight is given then the sum of masses of reactants and products are compared. In both cases, a boolean <code>TRUE</code> value is returned if the mass is balanced.</p>
<p>Mass balance can be tested using the chemical formula or the molecular weight associated to each metabolite as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">checkBalance</span>(<span class="dt">reactionList =</span> glycolysis<span class="op">$</span>REACTION,
             <span class="dt">referenceData =</span> chemicalData,
             <span class="dt">ids =</span> <span class="st">&quot;NAME&quot;</span>,
             <span class="dt">mFormula =</span> <span class="st">&quot;FORMULA&quot;</span>
             )
##  [1]  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
## [12]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE</code></pre></div>
<p>As is shown above, the third stoichiometric reaction is unbalanced. It can be corrected replacing manually the unbalanced reaction as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">glycolysis<span class="op">$</span>REACTION[<span class="dv">3</span>] &lt;-<span class="st"> &quot;D-Glyceraldehyde 3-phosphate[c] + Orthophosphate[c] + NAD+[c] &lt;=&gt; 3-Phospho-D-glyceroyl phosphate[c] + NADH[c] + H+[c]&quot;</span>

<span class="kw">checkBalance</span>(<span class="dt">reactionList =</span> glycolysis<span class="op">$</span>REACTION,
             <span class="dt">referenceData =</span> chemicalData,
             <span class="dt">ids =</span> <span class="st">&quot;NAME&quot;</span>,
             <span class="dt">mWeight =</span> <span class="st">&quot;MASS&quot;</span>
             )
##  [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
## [15] TRUE TRUE TRUE TRUE TRUE</code></pre></div>
<p>When all stoichiometric reactions are mass-balanced, then the model can be exported and loaded to be interrogated again:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">writeSBMLmod</span>(<span class="dt">modelData =</span> glycolysis,
          <span class="dt">modelID =</span> <span class="st">&quot;GlycolysisBalanced&quot;</span>,
          <span class="dt">outputFile =</span> <span class="st">&quot;glycolysisBalanced.xml&quot;</span>
          )

sybil<span class="op">::</span><span class="kw">optimizeProb</span>(sybilSBML<span class="op">::</span><span class="kw">readSBMLmod</span>(<span class="st">&quot;glycolysisBalanced.xml&quot;</span>))
## solver:                                   glpkAPI
## method:                                   simplex
## algorithm:                                fba
## number of variables:                      19
## number of constraints:                    18
## return value of solver:                   solution process was successful
## solution status:                          solution is optimal
## value of objective function (fba):        2.000000
## value of objective function (model):      2.000000</code></pre></div>
</div>
<div id="charge-balance-validation" class="section level4">
<h4>Charge Balance Validation</h4>
<p>Charge balance can be also tested through the <code>checkBalance</code> function using the net charge of metabolites as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">checkBalance</span>(<span class="dt">reactionList =</span> glycolysis<span class="op">$</span>REACTION,
             <span class="dt">referenceData =</span> chemicalData,
             <span class="dt">ids =</span> <span class="st">&quot;NAME&quot;</span>,
             <span class="dt">mCharge =</span> <span class="st">&quot;CHARGE&quot;</span>
             )
##  [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
## [15] TRUE TRUE TRUE TRUE TRUE</code></pre></div>
</div>
</div>
<div id="characterize-model" class="section level3">
<h3>Characterize model</h3>
<div id="stoichiometric-matrix" class="section level4">
<h4>Stoichiometric matrix</h4>
<p>A metabolic model is often represented in a more compact form called the stoichiometry matrix (<em>S</em>). If a metabolic model has <em>n</em> reactions and <em>m</em> participating metabolites, then the stoichiometry matrix will have correspondingly <em>m</em> rows and <em>n</em> columns. Values in the stoichiometric matrix represent the metabolites coefficients in each reaction. To generate the stoichiometric matrix just type:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stoichiometricMatrix</span>(<span class="dt">reactionList =</span> glycolysis<span class="op">$</span>REACTION)
##                                      reactions
## metabolites                           R01 R02 R03 R04 R05 R06 R07 R08 R09
##   2-Phospho-D-glycerate[c]             -1   0   0   0   0  -1   0   0   0
##   Phosphoenolpyruvate[c]                1   0   0   0   0   0   0   0   0
##   H2O[c]                                1   0   0   0   0   0   0   0   0
##   D-Glyceraldehyde 3-phosphate[c]       0  -1  -1   1   0   0   0   0   0
##   Glycerone phosphate[c]                0   1   0   1   0   0   0   0   0
##   Orthophosphate[c]                     0   0  -1   0   0   0   0   0   0
##   NAD+[c]                               0   0  -1   0   0   0   0   0   0
##   3-Phospho-D-glyceroyl phosphate[c]    0   0   1   0   1   0   0   0   0
##   NADH[c]                               0   0   1   0   0   0   0   0   0
##   H+[c]                                 0   0   1   0   0   0   0   0   0
##   beta-D-Fructose 1,6-bisphosphate[c]   0   0   0  -1   0   0   0   0   1
##   ATP[c]                                0   0   0   0  -1   0  -1   0  -1
##   3-Phospho-D-glycerate[c]              0   0   0   0  -1   1   0   0   0
##   ADP[c]                                0   0   0   0   1   0   1   0   1
##   alpha-D-Glucose[c]                    0   0   0   0   0   0  -1   0   0
##   alpha-D-Glucose 6-phosphate[c]        0   0   0   0   0   0   1  -1   0
##   beta-D-Fructose 6-phosphate[c]        0   0   0   0   0   0   0   1  -1
##   Pyruvate[c]                           0   0   0   0   0   0   0   0   0
##                                      reactions
## metabolites                           R10 R11 R12 R13 R14 R15 R16 R17 R18
##   2-Phospho-D-glycerate[c]              0   0   0   0   0   0   0   0   0
##   Phosphoenolpyruvate[c]               -1   0   0   0   0   0   0   0   0
##   H2O[c]                                0  -1   0   0   0   0   0   0   0
##   D-Glyceraldehyde 3-phosphate[c]       0   0   0   0   0   0   0   0   0
##   Glycerone phosphate[c]                0   0   0   0   0   0   0   0   0
##   Orthophosphate[c]                     0   0   0   0  -1   0   0   0   0
##   NAD+[c]                               0   0  -1   0   0   0   0   0   0
##   3-Phospho-D-glyceroyl phosphate[c]    0   0   0   0   0   0   0   0   0
##   NADH[c]                               0   0   0  -1   0   0   0   0   0
##   H+[c]                                 0   0   0   0   0  -1   0   0   0
##   beta-D-Fructose 1,6-bisphosphate[c]   0   0   0   0   0   0   0   0   0
##   ATP[c]                                1   0   0   0   0   0  -1   0   0
##   3-Phospho-D-glycerate[c]              0   0   0   0   0   0   0   0   0
##   ADP[c]                               -1   0   0   0   0   0   0   0   0
##   alpha-D-Glucose[c]                    0   0   0   0   0   0   0  -1   0
##   alpha-D-Glucose 6-phosphate[c]        0   0   0   0   0   0   0   0   0
##   beta-D-Fructose 6-phosphate[c]        0   0   0   0   0   0   0   0   0
##   Pyruvate[c]                           1   0   0   0   0   0   0   0  -1
##                                      reactions
## metabolites                           R19
##   2-Phospho-D-glycerate[c]              0
##   Phosphoenolpyruvate[c]                0
##   H2O[c]                                0
##   D-Glyceraldehyde 3-phosphate[c]       0
##   Glycerone phosphate[c]                0
##   Orthophosphate[c]                     0
##   NAD+[c]                               0
##   3-Phospho-D-glyceroyl phosphate[c]    0
##   NADH[c]                               0
##   H+[c]                                 0
##   beta-D-Fructose 1,6-bisphosphate[c]   0
##   ATP[c]                                0
##   3-Phospho-D-glycerate[c]              0
##   ADP[c]                               -1
##   alpha-D-Glucose[c]                    0
##   alpha-D-Glucose 6-phosphate[c]        0
##   beta-D-Fructose 6-phosphate[c]        0
##   Pyruvate[c]                           0</code></pre></div>
</div>
<div id="metabolites" class="section level4">
<h4>Metabolites</h4>
<p>The <code>metabolites</code> function automatically identifies and return all metabolites (with or without compartments) for a specific or a set of stoichiometric reactions. Some FBA implementations require the list of all metabolites included in the metabolic reconstruction as an independent section of the human-readable input model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">metabolites</span>(<span class="dt">reactionList =</span> glycolysis<span class="op">$</span>REACTION)
##  [1] &quot;2-Phospho-D-glycerate[c]&quot;           
##  [2] &quot;Phosphoenolpyruvate[c]&quot;             
##  [3] &quot;H2O[c]&quot;                             
##  [4] &quot;D-Glyceraldehyde 3-phosphate[c]&quot;    
##  [5] &quot;Glycerone phosphate[c]&quot;             
##  [6] &quot;Orthophosphate[c]&quot;                  
##  [7] &quot;NAD+[c]&quot;                            
##  [8] &quot;3-Phospho-D-glyceroyl phosphate[c]&quot; 
##  [9] &quot;NADH[c]&quot;                            
## [10] &quot;H+[c]&quot;                              
## [11] &quot;beta-D-Fructose 1,6-bisphosphate[c]&quot;
## [12] &quot;ATP[c]&quot;                             
## [13] &quot;3-Phospho-D-glycerate[c]&quot;           
## [14] &quot;ADP[c]&quot;                             
## [15] &quot;alpha-D-Glucose[c]&quot;                 
## [16] &quot;alpha-D-Glucose 6-phosphate[c]&quot;     
## [17] &quot;beta-D-Fructose 6-phosphate[c]&quot;     
## [18] &quot;Pyruvate[c]&quot;</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">metabolites</span>(<span class="dt">reactionList =</span> glycolysis<span class="op">$</span>REACTION,
            <span class="dt">woCompartment =</span> <span class="ot">TRUE</span>)
##  [1] &quot;2-Phospho-D-glycerate&quot;            &quot;Phosphoenolpyruvate&quot;             
##  [3] &quot;H2O&quot;                              &quot;D-Glyceraldehyde 3-phosphate&quot;    
##  [5] &quot;Glycerone phosphate&quot;              &quot;Orthophosphate&quot;                  
##  [7] &quot;NAD+&quot;                             &quot;3-Phospho-D-glyceroyl phosphate&quot; 
##  [9] &quot;NADH&quot;                             &quot;H+&quot;                              
## [11] &quot;beta-D-Fructose 1,6-bisphosphate&quot; &quot;ATP&quot;                             
## [13] &quot;3-Phospho-D-glycerate&quot;            &quot;ADP&quot;                             
## [15] &quot;alpha-D-Glucose&quot;                  &quot;alpha-D-Glucose 6-phosphate&quot;     
## [17] &quot;beta-D-Fructose 6-phosphate&quot;      &quot;Pyruvate&quot;</code></pre></div>
</div>
<div id="compartments" class="section level4">
<h4>Compartments</h4>
<p>As well as in cells, in which not all reactions occur in all compartments, stoichiometric reactions in a metabolic reconstruction can be labeled to be restricted to a single compartment during FBA through the assignment of a compartment label at the end of each metabolite name. Some FBA implementations require the list of all compartments included in the metabolic reconstruction as an independent section of the human-readable input file.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">compartments</span>(<span class="dt">reactionList =</span> glycolysis<span class="op">$</span>REACTION)
## [1] &quot;c&quot;</code></pre></div>
</div>
<div id="orphanmetabolites" class="section level4">
<h4>OrphanMetabolites</h4>
<p><code>orphanMetabolites</code> or compounds that are not produced or consumed in any other reaction are one of the main causes of mass accumulation in metabolic reconstructions. The <code>orphanReactants</code> function identifies compounds that are not produced internally by any other reaction and should be added to the reconstruction, for instance, as an exchange reaction while the <code>orphanProducts</code> function identifies compounds that are not consumed internally by any other reaction and should be added to the reconstruction as a sink reaction.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">orphanMetabolites</span>(<span class="dt">reactionList =</span> glycolysis<span class="op">$</span>REACTION[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])
## [1] &quot;alpha-D-Glucose[c]&quot; &quot;Pyruvate[c]&quot;        &quot;H+[c]&quot;             
## [4] &quot;H2O[c]&quot;             &quot;NAD+[c]&quot;            &quot;NADH[c]&quot;           
## [7] &quot;Orthophosphate[c]&quot;</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">orphanReactants</span>(<span class="dt">reactionList =</span> glycolysis<span class="op">$</span>REACTION[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])
## [1] &quot;alpha-D-Glucose[c]&quot; &quot;H+[c]&quot;              &quot;H2O[c]&quot;            
## [4] &quot;NAD+[c]&quot;            &quot;NADH[c]&quot;            &quot;Orthophosphate[c]&quot;
<span class="kw">orphanProducts</span>(<span class="dt">reactionList =</span> glycolysis<span class="op">$</span>REACTION[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])
## [1] &quot;Pyruvate[c]&quot;       &quot;H+[c]&quot;             &quot;H2O[c]&quot;           
## [4] &quot;NAD+[c]&quot;           &quot;NADH[c]&quot;           &quot;Orthophosphate[c]&quot;</code></pre></div>
</div>
</div>
<div id="tsv-files" class="section level3">
<h3>TSV files</h3>
<p>The function <code>writeTSVmod</code> writes a metabolic model in three text files, following a character-separated value format. Each line contains one entry; the default value separator is a tab. TSV models are the default input format for the <code>sybil</code> R package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">writeTSVmod</span>(<span class="dt">modelData =</span> glycolysis,
          <span class="dt">modelID =</span> <span class="st">&quot;Glycolysis&quot;</span>,
          <span class="dt">outputFile =</span> <span class="st">&quot;glycolysis&quot;</span>
          )

sybil<span class="op">::</span><span class="kw">readTSVmod</span>(<span class="dt">prefix =</span> <span class="st">&quot;glycolysis&quot;</span>,<span class="dt">quoteChar =</span> <span class="st">&quot;</span><span class="ch">\&quot;</span><span class="st">&quot;</span>)
## model name:             Glycolysis 
## number of compartments  1 
##                         [c] 
## number of reactions:    19 
## number of metabolites:  18 
## number of unique genes: 22 
## objective function:     +1 R00200</code></pre></div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
